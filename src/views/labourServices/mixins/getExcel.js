// import FileSaver from 'file-saver'import XLSX from 'xlsx'export default {  methods: {    importExcel(e) {      const that = this;      // that.tableData = [];      // that.tableName = [];      let files = e.target.files;      let fileReader = new FileReader();      let data,workbook,persons = []      fileReader.onload = function(ev) {        try {          data = ev.target.result          workbook = XLSX.read(data, {            type: "binary"          }) // 以二进制流方式读取得到整份excel表格对象        } catch (e) {          console.log("文件类型不正确");          return;        }        // 表格的表格范围，可用于判断表头是否数量是否正确        let fromTo = "";        // 遍历每张表读取        for (let sheet in workbook.Sheets) {          if (workbook.Sheets.hasOwnProperty(sheet)) {            fromTo = workbook.Sheets[sheet]["!ref"];            // console.log(fromTo);            persons = persons.concat(              XLSX.utils.sheet_to_json(workbook.Sheets[sheet])            );            // break; // 如果只取第一张表，就取消注释这行          }        }        console.log(persons);        return persons        // for (let i in persons) {        //   //format为自定义时间转换方法        //   persons[i]["记录时间"] = format(        //     excel_time_to_timestamp(persons[i]["记录时间"]),        //     "yyyy-MM-dd HH:mm:ss"        //   );        // }        // that.tableData = persons;        // for (let i in persons[0]) {        //   that.tableName.push(i);        // }      };      // 以二进制方式打开文件      fileReader.readAsBinaryString(files[0]);      //excel时间类型转成时间戳      // function excel_time_to_timestamp(excelTime) {      //   const second = 25569,      //     day_timestamp = 24 * 60 * 60 * 1000;      //   return (+excelTime - second) * day_timestamp;      // }    }  }}