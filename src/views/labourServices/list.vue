<template>  <el-main class="bg_white ">    <el-card class="box-card">      <div slot="header" class="clearfix">        <template v-for="(item, i) in funList">          <el-button :key="i" type="primary" size="small" round :disabled="item.disabled" v-show="!item.isHide" @click="handleFun(item.handle)">{{ item.name }}</el-button>        </template>      </div>      <div class="table-header c_h">        <el-table          ref="headerTable"          class="c_h"          :data="tableHeaderData"          :row-key="tableHeaderParam.rowKey"          :expand-row-keys="tableHeaderParam.expandRowKeys"          size="small"          height="300"          highlight-current-row          @selection-change="headerSelectionChange"        >          <el-table-column type="selection" width="55"></el-table-column>          <template v-for="(item, i) in tableHeaderParam.list">            <el-table-column :key="i" :label="item.name" :prop="item.key"></el-table-column>          </template>          <el-table-column type="expand">            <template slot-scope="props">              <el-form label-position="left" inline class="demo-table-expand">                <el-form-item label="商品名称">                  <span>{{ props.row.name }}</span>                </el-form-item>                <el-form-item label="商品名称">                  <span>{{ props.row.name }}</span>                </el-form-item>              </el-form>            </template>          </el-table-column>        </el-table>      </div>    </el-card>    <el-card class="c_m_t_n">      <el-table        class="c_h"        size="small"        height="200"        :data="tableFooterData"      >        <template v-for="(item, i) in tableFooterParam">          <el-table-column :key="i" :label="item.name" :prop="item.key"></el-table-column>        </template>      </el-table>    </el-card>  </el-main></template><script>    export default {        name: "labourServices",      data() {          return {            timer: undefined,            // [ 'select', 'edit', 'add', 'del', 'cancel', 'confirm', 'approval', 'joinApproval', 'dealtSelect', 'export']            funList: [              { name: '查询', type: 'primary', disabled: false, isHide: false, key: 'select', handle: 'selectHeader' },              { name: '修改', type: 'primary', disabled: false, isHide: false, key: 'edit', handle: 'editHeader' },              { name: '增加', type: 'primary', disabled: false, isHide: false, key: 'add', handle: 'addHeader' },              { name: '删除', type: 'primary', disabled: false, isHide: false, key: 'del', handle: 'delHeader' },              { name: '取消', type: 'primary', disabled: false, isHide: false, key: 'cancel', handle: 'cancelHeader' },              { name: '提交', type: 'primary', disabled: false, isHide: false, key: 'confirm', handle: 'confirmHeader' },              { name: '审批', type: 'primary', disabled: false, isHide: false, key: 'approval', handle: 'approvalHeader' },              { name: '联查审批情况', type: 'primary', disabled: false, isHide: false, key: 'joinApproval', handle: 'jointApprovalHeader' },              { name: '待办查询', type: 'primary', disabled: false, isHide: false, key: 'dealtSelect', handle: 'dealtSelectHeader' },              { name: '导入', type: 'primary', disabled: false, isHide: false, key: 'export', handle: 'exportHeader' },            ],            tableHeaderParam: {              list: [                // 单据编号		单据日期		项目			报销金额                // 经办人部门		经办人		附件张数			用途                // { name: '主键', key: 'cbillid', isUse: true },                // { name: '公司', key: 'pk_corp', isUse: true },                // { name: '部门', key: 'pk_dept', isUse: true },                // { name: '制单日期', key: 'doperatordate', isUse: true },                // { name: '单据日期', key: 'dbilldate', isUse: true },                // { name: '单据号', key: 'vbillno', isUse: true },                // { name: '单据状态', key: 'vbillstatus', isUse: true },                // { name: '单据类型', key: 'pk_billtype', isUse: true },                // { name: '业务类型', key: 'pk_busitype', isUse: true },                // { name: '制单人', key: 'voperatorid', isUse: true },                // { name: '制单时间', key: 'tmaketime', isUse: true },                // { name: '审核人', key: 'vapproveid', isUse: true },                // { name: '审核日期', key: 'dapprovedate', isUse: true },                // { name: '审核批语', key: 'vapprovenote', isUse: true },                // { name: '最后修改人', key: 'clastmodifier', isUse: true },                // { name: '最后修改时间', key: 'tlastmodifytime', isUse: true },                { name: '单据编号', key: 'vbillno', isUse: true },                { name: '单据日期', key: 'dbilldate', isUse: true },                { name: '项目', key: 'project', isUse: true },                { name: '报销金额', key: 'amount', isUse: true },                { name: '经办人部门', key: 'managerdept', isUse: true },                { name: '经办人', key: 'managerdept', isUse: true },                { name: '附件张数', key: 'attachmentnum', isUse: true },                { name: '用途', key: 'purpose', isUse: true }              ],              rowKey: 'vbillno',              expandRowKeys: []            },            tableFooterParam: [              //序号	姓名	银行卡号	开户行	联行号	应发	税率	税额	实发	备注 人员档案主键	人员银行账户主键              { name: '序号', key: 'rowno', isUse: true },              { name: '姓名', key: 'name', isUse: true },              { name: '银行卡号', key: 'banknum', isUse: true },              { name: '开户行', key: 'crtbank', isUse: true },              { name: '联行号', key: 'combinenum', isUse: true },              { name: '应发', key: 'should', isUse: true },              { name: '税率', key: 'ntaxrate', isUse: true },              { name: '税额', key: 'ntax', isUse: true },              { name: '实发', key: 'reality', isUse: true },              { name: '备注', key: 'memo', isUse: true },              { name: '人员档案主键', key: 'pk_psndoc', isUse: false },              { name: '人员银行账户主键', key: 'pk_bankacc', isUse: false},            ],            tableHeaderData: [{vbillno: 1}, {vbillno: 2}, {vbillno: 3}, {vbillno: 4}, {vbillno: 5}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}],            tableFooterData: [{rowno: 11}, {rowno: 22}, {rowno: 33}, {rowno: 44}, {rowno: 55}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}],            // 当前被选中表头项            headerTableSelectionData: {}          }      },      methods: {          // 功能菜单事件        handleFun(name) {          let row = this.headerTableSelectionData;          if (row && row.vbillno) {            this[name](row);          } else {            this.$message("请选择需要操作的单据");          }        },        // 功能菜单权限控制        setFunAuth(list = [ 'select', 'edit', 'add', 'del', 'cancel', 'confirm', 'approval', 'joinApproval', 'dealtSelect', 'export']) {          // [ 'select', 'edit', 'add', 'del', 'cancel', 'confirm', 'approval', 'joinApproval', 'dealtSelect', 'export']          this.funList = this.funList.map(item => {            item.disabled = list.includes(item.key)          })        },        // 查询        selectHeader() {},        // 修改        editHeader(row) {          this.expandRow(row)        },        // 增加        addHeader() {},        // 删除        delHeader() {},        // 取消        cancelHeader(row) {          this.expandRow(row, false)        },        // 提交        confirmHeader() {},        // 审批        approvalHeader() {},        // 联查审批        jointApprovalHeader() {},        // 待办查询        dealtSelectHeader() {},        // 导入        exportHeader() {},        // ===== 表格操作        // 表头项展开事件 - 表头 ： vbillno        expandRow(row, isExpand = true) {          this.$refs.headerTable.toggleRowExpansion(row, isExpand);        },        // 表头项选中事件        selectionRow(row, isSelect = true) {          this.$refs.headerTable.toggleRowSelection(row, isSelect);        },        // 表头项清空选中事件        clearSelection() {          this.$refs.headerTable.clearSelection();        },        // 获取row的key值        getRowKeys(row) {          return row.vbillno;        },        // 表头选中事件 - 实现单选操作        headerSelectionChange(val) {          const self = this;          if (val[1]) {            this.selectionRow(val[0], false);            this.expandRow(val[0], false);            this.selectionRow(val[1], true);          }          this.headerTableSelectionData = val[1] || val[0];          this.throttle(()=> {            self.getFooterData()          })        },        // ===== 数据请求        //请求表体内容        getFooterData() {          let row = this.headerTableSelectionData          // -- ajax : row          // -- callback          this.tableFooterData = [{rowno: 111}, {rowno: 222}, {rowno: 333}, {rowno: 'p44'}, {rowno: 555}].map(item => {            item.rowno = row.vbillno + '---' + item.rowno            return item          })        },        // 节流        throttle(fun, duration = 1000) {          if (this.timer)clearTimeout(this.timer)          this.timer = setTimeout(() => {            if (fun)fun()          }, duration)        }      }    }</script><style scoped>.table-header{  /*min-height: 200px;*/}</style>